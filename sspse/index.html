<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Source Themes Academic 4.8.0"><meta name=description content="The sspse package This is an R package to implement successive sampling population size estimation (SS-PSE).
SS-PSE is used to estimate the size of hidden populations using respondent-driven sampling (RDS) data."><link rel=alternate hreflang=en-us href=https://HPMRG.github.io/sspse/><meta name=theme-color content="#2962ff"><script src=/js/mathjax-config.js></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.8.6/css/academicons.min.css integrity="sha256-uFVgMKfistnJAfoCUQigIl+JfUaP47GrRKjf6CTPVmw=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-1/css/all.min.css integrity="sha256-4w9DunooKSr3MFXHXWyFER38WmPdm361bQS/2KUWZbU=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.css integrity="sha256-Vzbj7sDDS/woiFS3uNKo8eIuni59rjyNGtXfstRzStA=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/github.min.css crossorigin=anonymous title=hl-light><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/styles/dracula.min.css crossorigin=anonymous title=hl-dark disabled><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.css integrity="sha256-SHMGCYmST46SoyGgo4YR/9AlK1vf3ff84Aq9yK4hdqM=" crossorigin=anonymous><script src=https://cdnjs.cloudflare.com/ajax/libs/lazysizes/5.1.2/lazysizes.min.js integrity="sha256-Md1qLToewPeKjfAHU1zyPwOutccPAm5tahnaw7Osw0A=" crossorigin=anonymous async></script>
<script src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js integrity crossorigin=anonymous async></script>
<link rel=stylesheet href="https://fonts.googleapis.com/css?family=Lato:400,700%7CMerriweather%7CRoboto+Mono&display=swap"><link rel=stylesheet href=/css/academic.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-169798863-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(e,t){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon",event_callback:function(){t!=="_blank"&&(document.location=e)}}),console.debug("Outbound link clicked: "+e)}function onClickCallback(e){if(e.target.tagName!=="A"||e.target.host===window.location.host)return;trackOutboundLink(e.target,e.target.getAttribute("target"))}gtag("js",new Date),gtag("config","UA-169798863-1",{}),document.addEventListener("click",onClickCallback,!1)</script><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/images/icon_hudbb3ba68f2c351cd24da270c82e7fb6b_6716_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/images/icon_hudbb3ba68f2c351cd24da270c82e7fb6b_6716_192x192_fill_lanczos_center_3.png><link rel=canonical href=https://HPMRG.github.io/sspse/><meta property="twitter:card" content="summary"><meta property="og:site_name" content="Mark S. Handcock"><meta property="og:url" content="https://HPMRG.github.io/sspse/"><meta property="og:title" content=" | Mark S. Handcock"><meta property="og:description" content="The sspse package This is an R package to implement successive sampling population size estimation (SS-PSE).
SS-PSE is used to estimate the size of hidden populations using respondent-driven sampling (RDS) data."><meta property="og:image" content="https://HPMRG.github.io/images/logo_hu7ac5a2aa8fa12518fd9ab7ceccb2a15e_77341_300x300_fit_lanczos_3.png"><meta property="twitter:image" content="https://HPMRG.github.io/images/logo_hu7ac5a2aa8fa12518fd9ab7ceccb2a15e_77341_300x300_fit_lanczos_3.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-08-24T00:00:00+00:00"><meta property="article:modified_time" content="2022-08-24T00:00:00+00:00"><title>| Mark S. Handcock</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents><aside class=search-results id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=#><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/><img src=/images/logo_hu7ac5a2aa8fa12518fd9ab7ceccb2a15e_77341_0x70_resize_lanczos_3.png alt="Mark S. Handcock"></a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/><img src=/images/logo_hu7ac5a2aa8fa12518fd9ab7ceccb2a15e_77341_0x70_resize_lanczos_3.png alt="Mark S. Handcock"></a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/aboutus/><span>About us</span></a></li><li class=nav-item><a class=nav-link href=/rdsanalyst/><span>RDS Analyst software</span></a></li><li class=nav-item><a class=nav-link href=/software/><span>Other software</span></a></li><li class=nav-item><a class=nav-link href=/citation/><span>How to Cite us</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li><li class="nav-item dropdown theme-dropdown"><a href=# class="nav-link js-theme-selector" data-toggle=dropdown aria-haspopup=true><i class="fas fa-palette" aria-hidden=true></i></a><div class=dropdown-menu><a href=# class="dropdown-item js-set-theme-light"><span>Light</span></a>
<a href=# class="dropdown-item js-set-theme-dark"><span>Dark</span></a>
<a href=# class="dropdown-item js-set-theme-auto"><span>Automatic</span></a></div></li></ul></div></nav><article class=article><div class="article-container pt-3"><h1></h1><div class=article-metadata></div></div><div class=article-container><div class=article-style><img src=/img/sspse_hl.png align=left width=250 height=250 style=padding:30px alt="RDS network"><h1 id=the-sspse-package>The <code>sspse</code> package</h1><p>This is an R package to implement successive sampling population size estimation (SS-PSE).</p><p>SS-PSE is used to estimate the size of hidden populations using respondent-driven sampling (RDS) data. The package can implement SS-PSE,
visibility SS-PSE, and capture-recapture SS-PSE.</p><p>The package was developed by the
<a href=https://hpmrg.org target=_blank rel=noopener>Hard-to-Reach Population Methods Research Group (HPMRG)</a>.</p><img src=/img/fauxmadrona_recplot.jpeg width=900 alt="sspse banner"><h1 id=installation>Installation</h1><p>The package is available on CRAN and can be installed using</p><pre><code class=language-{r}>install.packages(&quot;sspse&quot;)
</code></pre><p>To install the latest development version from github, the best way it to use git to create a local copy and install it as usual from there. If
you just want to install it, you can also use:</p><pre><code class=language-{r}># If devtools is not installed:
# install.packages(&quot;devtools&quot;)

devtools::install_github(&quot;HPMRG/sspse&quot;)
</code></pre><h1 id=implementation>Implementation</h1><p>Load package and example data</p><pre><code>library(sspse)
data(fauxmadrona)
</code></pre><p><code>fauxmadrona</code> is a simulated RDS data set with no seed dependency, which is used to demonstrate RDS estimators. It has the format of an
<code>rds.data.frame</code> and is a sample of size 500 with 10 seeds and 2 coupons from a population of size 1000. For the purpose of this example, we
will assume the population size is unknown and our goal is to estimate it.</p><p>We can make a quick visualization of the recruitment chains, where the size of the node is proportional to the reported degree and the color
represents separate chains.</p><pre><code class=language-{r}>reingold.tilford.plot(fauxmadrona, 
                      vertex.label=NA, 
                      vertex.size=&quot;degree&quot;,
                      show.legend=FALSE,
                      vertex.color=&quot;seed&quot;)
</code></pre><p><img src=reingold.tilford.png alt></p><h2 id=the-posteriorsize-function>The <code>posteriorsize()</code> function</h2><p>The function that will perform both the original and visibility variants of SS-PSE is called <code>posteriorsize()</code>. It requires some prior knowledge
about the population size, $N$, which is usually expressed using the <code>median.prior.size=</code> argument.</p><p>Although there are many options within the <code>posteriorsize</code> function, most can be left at their default values unless you have a specific reason
to believe they should be set differently.</p><h2 id=original-ss-pse-example>Original SS-PSE example</h2><p>Set <code>visibility=FALSE</code>. By default, 1000 samples will be drawn from the posterior distribution for $N$ using a burnin of 1000 and an interval of
10. This may take a few seconds to run.</p><pre><code>fit1 &lt;- posteriorsize(fauxmadrona, 
              median.prior.size=1000,
              visibility=FALSE)
</code></pre><pre><code>## Using non-measurement error model with K = 14.
## Taken 1 samples...
## Taken 2 samples...
## Taken 4 samples...
...
## Taken 500 samples...
## Taken 1000 samples...
</code></pre><p>Plot the posterior distribution for $N$.</p><pre><code>plot(fit1, type=&quot;N&quot;)
</code></pre><p><img src=fit.nme.png alt></p><p>Create a table summary for the prior and posterior distributions for population size, specifying that we are interested in a 90% credible
interval for $N$.</p><pre><code>summary(fit1, HPD.level = 0.9)
</code></pre><pre><code>## Summary of Population Size Estimation
##           Mean Median Mode 25%  75%  90%  5%  95%
## Prior     1247   1000  680 748 1480 2240 583 2852
## Posterior  974    936  874 808 1100 1275 656 1400
</code></pre><h2 id=visibility-ss-pse-example>Visibility SS-PSE example</h2><p>Set <code>visibility=TRUE</code>. Because of the measurement error model, this model will take a little longer to fit - perhaps a minute or so.</p><pre><code>fit2 &lt;- posteriorsize(fauxmadrona, 
              median.prior.size=1000,
              visibility=TRUE)
</code></pre><pre><code>## Using a Exponentially Weighted Poisson measurement error model with K = 35.

## computing ...
## Taken 1 samples...
## Taken 2 samples...
...
## Taken 500 samples...
## Taken 1000 samples...
</code></pre><h2 id=summary-of-population-size-estimation>Summary of Population Size Estimation</h2><p>Plot the posterior distribution for $N$.</p><pre><code>plot(fit2, type=&quot;N&quot;)
</code></pre><p><img src=fit.me.png alt></p><p>Create a table summary for the prior and posterior distributions for population size, specifying that we are interested in a 90% credible
interval for $N$.</p><pre><code>summary(fit2, HPD.level = 0.9)
</code></pre><pre><code>## Summary of Population Size Estimation
##           Mean Median Mode 25%  75%  90%  5%  95%
## Prior     1247   1000  680 748 1480 2240 583 2852
## Posterior 1254   1100  913 858 1482 2016 621 2425
</code></pre><h1 id=resources>Resources</h1><p>Please use the GitHub repository to report bugs or request features:
<a href=https://https://github.com/HPMRG/sspse target=_blank rel=noopener>https://github.com/HPMRG/sspse</a></p><p>See the following papers for more information and examples:</p><h4 id=statistical-methodology>Statistical Methodology</h4><ul><li>Handcock, Mark S.; Gile, Krista J. and Mar, Corinne M. (2014)
<a href=https://doi.org/10.1214/14-ejs923 target=_blank rel=noopener>Estimating Hidden Population Size using Respondent-Driven Sampling
Data</a>, <em>Electronic Journal of Statistics</em>, 8(1):1491-1521.</li><li>Handcock, Mark S.; Gile, Krista J. and Mar, Corinne M. (2015)
<a href=https://doi.org/10.1111/biom.12255 target=_blank rel=noopener>Estimating the Size of Populations at High Risk for HIV using Respondent-Driven
Sampling Data</a>, <em>Biometrics</em>, 71(1):258-266.</li><li>Kim, Brian J. and Handcock, Mark S. (2021)
<a href=https://doi.org/10.1093/jssam/smz055 target=_blank rel=noopener>Population Size Estimation Using Multiple Respondent-Driven Sampling
Surveys</a>, <em>Journal of Survey Statistics and Methodology</em>, 9(1):94–120.</li><li>McLaughlin, Katherine R.; Johnston, Lisa G.; Jakupi, Xhevat; Gexha-Bunjaku, Dafina; Deva, Edona and Handcock, Mark S.
(2023)
<a href="https://www.e-publications.org/ims/submission/AOAS/user/submissionFile/53943?confirm=5e420195" target=_blank rel=noopener>Modeling the Visibility Distribution for Respondent-Driven Sampling with Application to Population Size Estimation</a>, <em>Annals of Applied Statistics</em>.</li></ul><h4 id=applications>Applications</h4><ul><li>Johnston, Lisa G., McLaughlin, Katherine R., El Rhilani, Houssine, Latifi, Amina, Toufik, Abdalla, Bennani, Aziza, Alami, Kamal, Elomari,
Boutaina, and Handcock, Mark S. (2015)
<a href=https://doi.org/10.1097/EDE.0000000000000362 target=_blank rel=noopener>Estimating the Size of Hidden Populations Using Respondent-driven Sampling Data: Case Examples from
Morocco</a>, <em>Epidemiology</em>, 26(6):846-852.</li><li>Johnston, Lisa G., McLaughlin, Katherine R., Rouhani, Shada A., and Bartels, Susan A. (2017)
<a href=https://doi.org/10.1016/j.jegh.2016.08.003 target=_blank rel=noopener>Measuring a Hidden Population: A Novel Technique
to Estimate the Population Size of Women with Sexual Violence-Related Pregnancies in South Kivu Province, Democratic Republic of
Congo</a>, <em>Journal of Epidemiology and Global Health</em>, 7(1):45-53.</li><li>McLaughlin, Katherine R., Johnston, Lisa G., Gamble, Laura J., Grigoryan, Trdat, Papoyan, Arshak, and Grigoryan, Samvel (2019)
<a href=https://doi.org/10.2196/12034 target=_blank rel=noopener>Population
Size Estimations Among Hidden Populations Using Respondent-Driven Sampling Surveys: Case Studies From Armenia</a>,
<em>JMIR Public Health and Surveillance</em>, 5(1):e12034.</li><li>Johnston, Lisa G., McLaughlin, Katherine R., Gios, Lorenzo, Cordioli, Maddalena, Staneková, Danica V.,Blondeel, Karel, Toskin, Igor,
Mirandola, Massimo, and The SIALON II Network (2021)
<a href=https://doi.org/10.1093/eurpub/ckab148 target=_blank rel=noopener>Populations size estimations using SS-PSE among MSM in four European cities: how many
MSM are living with HIV?</a>, <em>European Journal of Public Health</em>, 31(6):1129–1136.</li></ul></div><div class=article-tags><a class="badge badge-light" href=/tag/software/>software</a></div></div></article><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/fancybox/3.5.7/jquery.fancybox.min.js integrity="sha256-yt2kYMy0w8AbtF89WXb2P1rfjcP/HTHLT7097U8Y5b8=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/highlight.min.js integrity="sha256-eOgo0OtLL4cdq7RdwRUiGKLX9XsIJ7nGhWEKbohmVAQ=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.18.1/languages/r.min.js></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.5.1/leaflet.js integrity="sha256-EErZamuLefUnbMBQbsEqu1USa+btR2oIlCpBJbyD4/g=" crossorigin=anonymous></script>
<script>const code_highlighting=!0</script><script>const isSiteThemeDark=!1</script><script>const search_config={indexURI:"/index.json",minLength:1,threshold:.3},i18n={no_results:"No results found",placeholder:"Search...",results:"results found"},content_type={post:"Posts",project:"Projects",publication:"Publications",talk:"Talks",slides:"Slides"}</script><script id=search-hit-fuse-template type=text/x-template>
      <div class="search-hit" id="summary-{{key}}">
      <div class="search-hit-content">
        <div class="search-hit-name">
          <a href="{{relpermalink}}">{{title}}</a>
          <div class="article-metadata search-hit-type">{{type}}</div>
          <p class="search-hit-description">{{snippet}}</p>
        </div>
      </div>
      </div>
    </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script>
<script id=dsq-count-scr src=https://HPMRG.disqus.com/count.js async></script>
<script src=/js/academic.min.cd45a9c0bbdd3dfb1c126917c601c9f2.js></script><div class=container><footer class=site-footer><p class=powered-by>2022</p><p class=powered-by>Powered by the
<a href=https://sourcethemes.com/academic/ target=_blank rel=noopener>Academic theme</a> for
<a href=https://gohugo.io target=_blank rel=noopener>Hugo</a>.
<span class=float-right aria-hidden=true><a href=# class=back-to-top><span class=button_icon><i class="fas fa-chevron-up fa-2x"></i></span></a></span></p></footer></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div></body></html>